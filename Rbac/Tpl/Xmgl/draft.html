<link rel="shortcut icon" href="favicon.ico">
<link href="css/bootstrap.min.css?v=3.3.6" rel="stylesheet">

<link href="css/plugins/dataTables/dataTables.bootstrap.css" rel="stylesheet">
<link href="css/font-awesome.css?v=4.4.0" rel="stylesheet">
<link href="css/animate.css" rel="stylesheet">
<link href="css/style.css?v=4.1.0" rel="stylesheet">
<link rel="stylesheet" href="css/main.css">

<div class="modal-header">
<button type="button" class="close" data-dismiss="modal">×</button>
<h4 class="modal-title">材料登记</h4>
</div>

<form id="format1" method="post" action="__URL__/insert" enctype="multipart/form-data" class="form-horizontal">    
	<div class="modal-body">
		<div class="form-group">
			<input type="hidden" id="plmid" value="{$id}" name="plmid">
			<div class="">
				<a onclick="fnClickAddRow();" href="javascript:void(0);" class="btn btn-primary ">添加行</a>
			</div>
			
			<table class="table table-striped table-bordered table-hover " id="editable">
				<thead>
					<tr>
						<th width="17%">材料类别</th>
						<th width="10%">材料编号</th>
						<th width="10%">材料名称</th>
						<th width="10%">规格型号</th>
						<th width="6%">单位</th>
						<th width="5%">操作</th>
					</tr>
				</thead>
				<tbody>
					<volist name="materials" id="material">
					<tr id="table-row-0">
						<td>
						<select class="form-control" name="para1[]" id="para1_{$key}">
							<option value="">选择材料类别</option>
							<volist name="brand" id="brandlist">
							<option value="{$brandlist.id}" <eq name="material.brandid" value="$brandlist.id">selected</eq>>{$brandlist.name}</option>
							</volist>
						</select>
						</td>
						<td><input type="text" placeholder="材料编号" class="form-control" size="10%" name="para2[]" id="para2_{$key}" value="{$material.number}"></td>
						<td><input type="text" placeholder="材料名称" class="form-control" size="10%" name="para3[]" id="para3_{$key}" value="{$material.name}"></td>
						<td><input type="text" placeholder="规格型号" class="form-control" size="10%" name="para4[]" id="para4_{$key}" value="{$material.standard}"></td>
						<td><input type="text" placeholder="单位" class="form-control" size="5%" name="para5[]" id="para5_{$key}" value="{$material.unit}"></td>
						<td> 
						<a class="btn btn-danger btn-xs delete" href="javascript:void(0);">删除</a>
						</td>				
					</tr>
					</volist>
				</tbody>
			</table>
		</div>
		<div class="btn1">
								
		</div>
	</div>	
	<div class="modal-footer">
		<button type="button" class="btn btn-sm btn-white pull-right m-t-n-xs" data-dismiss="modal" style="margin-left:10px">关闭</button>
		
		<button class="btn btn-sm btn-primary pull-right m-t-n-xs" type="button" id="sub"><strong>确定</strong>
		</button>
		
	</div>
</form> 
	
	<script src="js/plugins/validate/jquery.validate.min.js"></script>
    <script src="js/plugins/validate/messages_zh.min.js"></script>
    <script src="js/demo/form-validate-demo.js"></script>
	
	
	<script src="js/plugins/jeditable/jquery.jeditable.js"></script>
    <script src="js/plugins/dataTables/jquery.dataTables.js"></script>
    <script src="js/plugins/dataTables/dataTables.bootstrap.js"></script>
	<script>
		var table=$('#editable').dataTable();
    </script>
	
	<script>
		var currentrow=<?php echo $materialcount?>;
        function fnClickAddRow() {
            $('#editable').dataTable().fnAddData([
				'<select class="form-control" name="para1[]" id="para1_'+currentrow+'"><option value="">选择材料类别</option><volist name="brand" id="brandlist"><option value="{$brandlist.id}">{$brandlist.name}</option></volist></select>',
				'<input type="text" placeholder="材料编号" class="form-control" size="10%" name="para2[]" id="para2_'+currentrow+'">',
                '<input type="text" placeholder="材料名称" class="form-control" size="10%" name="para3[]" id="para3_'+currentrow+'">',
                '<input type="text" placeholder="规格型号" class="form-control" size="10%" name="para4[]" id="para4_'+currentrow+'">',
                '<input type="text" placeholder="单位" class="form-control" size="5%" name="para5[]" id="para5_'+currentrow+'">',
				'<a class="btn btn-danger btn-xs delete" href="javascript:void(0);">删除</a>'
				]);
			currentrow++;
			$('.delete').on('click', function(e) {
				var table = $('#editable').DataTable();
				table.row($(this).parents('tr')).remove().draw();
			});
        }
    </script>
	
	<script>
	    $("#sub").click(function(){
		    $("#format1").submit();
		})
	</script>
	