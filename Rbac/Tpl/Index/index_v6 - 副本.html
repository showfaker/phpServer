<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{$moduletitle}</title>
	<!--
	<link href="css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
	-->
    <link href="css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="css/animate.css" rel="stylesheet">
    <link href="css/stylegantt.css?v=4.1.0" rel="stylesheet">
	
	
	<link rel="stylesheet" href="__PUBLIC__/gantt/css/style.css" />  
	<link rel="stylesheet" href="css/main.css">

</head>

<body class="gray-bg">

	<input type="hidden" name="plmid" id="plmid" value="{$detail.id}">
	<table style="display:none">
		<thead>
		<tr>
		</tr>
		</thead>
		<?php 
		function getBegintime($begintime,$currentfinishtime)
		{
			if($begintime!=0)
			{
				if(date('Y-m-d',$begintime) == date('Y-m-d',$currentfinishtime))
				{
					echo date('Y-m-d',$begintime);
				}
				else
				{
					echo date('Y-m-d',$begintime+24*60*60);
				}
			}
		}
		function getBegintimestr($begintime,$currentfinishtime)
		{
			if($begintime!=0)
			{
				if($begintime == $currentfinishtime)
				{
					echo $begintime;
				}
				else
				{
					echo date('Y-m-d',strtotime($begintime)+24*60*60);
				}
			}
		}
		?>
		
		
		<tbody>
			<neq name="orgdata.predate0" value="">
			<tr target="sid_obj"><td class="l" id="项目立项">项目立项</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="项目立项_1">项目立项</td><td id="项目立项_项目立项_plantimebegin">{$orgdata['predate0']}</td><td id="项目立项_项目立项_plantimeend">{$orgdata['predate0']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="项目立项_4">项目立项</td><td id="项目立项_项目立项_timebegin"><?php if($orgdata['submit_time']!=0)echo date('Y-m-d',$orgdata['submit_time']);?></td>
				<td id="项目立项_项目立项_timeend"><?php if($orgdata['submit_time']!=0)echo date('Y-m-d',$orgdata['submit_time']);?></td><td id="项目立项_项目立项_percent">100%</td><td id="项目立项_项目立项_daily">完成</td>
			</tr>
			</neq>
			<neq name="orgdata.predate1" value="">
			<tr target="sid_obj"><td class="l" id="立项申请审核">立项申请审核</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="立项申请审核_1">立项申请审核</td><td id="立项申请审核_立项申请审核_plantimebegin"><?php if($orgdata['predate0']!=0)echo date('Y-m-d',strtotime($orgdata['predate0'])+24*60*60);?></td><td id="立项申请审核_立项申请审核_plantimeend">{$orgdata['predate1']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="立项申请审核_4">立项申请审核</td><td id="立项申请审核_立项申请审核_timebegin"><?php getBegintime($orgdata['submit_time'],$orgdata['submit_approve_time']);?></td>
				<td id="立项申请审核_立项申请审核_timeend"><?php if($orgdata['submit_approve_time']!=0)echo date('Y-m-d',$orgdata['submit_approve_time']);?></td><td id="立项申请审核_立项申请审核_percent">100%</td><td id="立项申请审核_立项申请审核_daily">完成</td>
			</tr>
			</neq>
			<neq name="orgdata.predate2" value="">
			<tr target="sid_obj"><td class="l" id="可研编制">可研编制</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="可研编制_1">可研编制</td><td id="可研编制_可研编制_plantimebegin"><?php if($orgdata['predate1']!=0)echo date('Y-m-d',strtotime($orgdata['predate1'])+24*60*60);?></td><td id="可研编制_可研编制_plantimeend">{$orgdata['predate2']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="可研编制_4">可研编制</td><td id="可研编制_可研编制_timebegin"><?php getBegintime($orgdata['submit_approve_time'],$orgdata['research_time']);?></td>
				<td id="可研编制_可研编制_timeend"><?php if($orgdata['research_time']!=0)echo date('Y-m-d',$orgdata['research_time']);?></td><td id="可研编制_可研编制_percent">100%</td><td id="可研立项_可研立项_daily">完成</td>
			</tr>
			</neq>
			<neq name="orgdata.predate3" value="">
			<tr target="sid_obj"><td class="l" id="可研评审报告">可研评审报告</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="可研评审报告_1">可研评审报告</td><td id="可研评审报告_可研评审报告_plantimebegin"><?php if($orgdata['predate2']!=0)echo date('Y-m-d',strtotime($orgdata['predate2'])+24*60*60);?></td><td id="可研评审报告_可研评审报告_plantimeend">{$orgdata['predate3']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="可研评审报告_4">可研评审报告</td><td id="可研评审报告_可研评审报告_timebegin"><?php getBegintime($orgdata['research_time'],$orgdata['research_time1']);?></td>
				<td id="可研评审报告_可研评审报告_timeend"><?php if($orgdata['research_time1']!=0)echo date('Y-m-d',$orgdata['research_time1']);?></td><td id="可研评审报告_可研评审报告_percent">100%</td><td id="可研评审报告_可研评审报告_daily">完成</td>
			</tr>
			</neq>
			<neq name="orgdata.predate4" value="">
			<tr target="sid_obj"><td class="l" id="可研评审报告审核">可研评审报告审核</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="可研评审报告审核_1">可研评审报告审核</td><td id="可研评审报告审核_可研评审报告审核_plantimebegin"><?php if($orgdata['predate3']!=0)echo date('Y-m-d',strtotime($orgdata['predate3'])+24*60*60);?></td><td id="可研评审报告审核_可研评审报告审核_plantimeend">{$orgdata['predate4']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="可研评审报告审核_4">可研评审报告审核</td><td id="可研评审报告审核_可研评审报告审核_timebegin"><?php getBegintime($orgdata['research_time1'],$orgdata['research_approve_time']);?></td>
				<td id="可研评审报告审核_可研评审报告审核_timeend"><?php if($orgdata['research_approve_time']!=0)echo date('Y-m-d',$orgdata['research_approve_time']);?></td><td id="可研评审报告审核_可研评审报告审核_percent">100%</td><td id="可研评审报告审核_可研评审报告审核_daily">完成</td>
			</tr>
			</neq>
			<!-- 
			<neq name="orgdata.predate5" value="">
			<tr target="sid_obj"><td class="l" id="可研省公司审核">可研省公司审核</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="可研编制省公司审核_1">可研省公司审核</td><td id="可研省公司审核_可研省公司审核_plantimebegin"><?php if($orgdata['predate4']!=0)echo date('Y-m-d',strtotime($orgdata['predate4'])+24*60*60);?></td><td id="可研省公司审核_可研省公司审核_plantimeend">{$orgdata['predate5']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="可研省公司审核_4">可研省公司审核</td><td id="可研省公司审核_可研省公司审核_timebegin"><?php getBegintime($orgdata['research_approve_time'],$orgdata['research_approve_time1']);?></td>
				<td id="可研省公司审核_可研省公司审核_timeend"><?php if($orgdata['research_approve_time1']!=0)echo date('Y-m-d',$orgdata['research_approve_time1']);?></td><td id="可研省公司审核_可研省公司审核_percent">100%</td><td id="可研省公司审核_可研省公司审核_daily">完成</td>
			</tr>
			</neq>
			 -->
			 
			 <neq name="orgdata.predate6" value="">
			<tr target="sid_obj"><td class="l" id="提交合作协议">提交合作协议</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="提交合作协议_1">提交合作协议</td><td id="提交合作协议_提交合作协议_plantimebegin">
				<eq name="orgdata.research_approve_time1" value="">
				<?php if($orgdata['predate4']!=0)echo date('Y-m-d',strtotime($orgdata['predate4'])+24*60*60);?>
				</eq>
				<neq name="orgdata.research_approve_time1" value="">
				<?php if($orgdata['predate5']!=0)echo date('Y-m-d',strtotime($orgdata['predate5'])+24*60*60);?>
				</neq>
				</td><td id="提交合作协议_提交合作协议_plantimeend">{$orgdata['predate6']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<eq name="orgdata.research_approve_time1" value="">
				<td class="提交合作协议_4">提交合作协议</td><td id="提交合作协议_提交合作协议_timebegin"><?php getBegintime($orgdata['research_approve_time'],$orgdata['cooperate_time']);?></td>
				</eq>
				<neq name="orgdata.research_approve_time1" value="">
				<td class="提交合作协议_4">提交合作协议</td><td id="提交合作协议_提交合作协议_timebegin"><?php getBegintime($orgdata['research_approve_time1'],$orgdata['cooperate_time']);?></td>
				</neq>
				<td id="提交合作协议_提交合作协议_timeend"><?php if($orgdata['cooperate_time']!=0)echo date('Y-m-d',$orgdata['cooperate_time']);?></td><td id="提交合作协议_提交合作协议_percent">100%</td><td id="提交合作协议_提交合作协议_daily">完成</td>
			</tr>
			</neq>
			
			 <neq name="orgdata.predate6x" value="">
			<tr target="sid_obj"><td class="l" id="提交综合计划复批文件">提交综合计划复批文件</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="提交综合计划复批文件_1">提交综合计划复批文件</td><td id="提交综合计划复批文件_提交综合计划复批文件_plantimebegin"><?php if($orgdata['predate6']!=0)echo date('Y-m-d',strtotime($orgdata['predate6'])+24*60*60);?></td><td id="提交综合计划复批文件_提交综合计划复批文件_plantimeend">{$orgdata['predate6x']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="提交综合计划复批文件_4">提交综合计划复批文件</td><td id="提交综合计划复批文件_提交综合计划复批文件_timebegin"><?php getBegintime($orgdata['cooperate_time'],$orgdata['planfile_time']);?></td>
				<td id="提交综合计划复批文件_提交综合计划复批文件_timeend"><?php if($orgdata['planfile_time']!=0)echo date('Y-m-d',$orgdata['planfile_time']);?></td><td id="提交综合计划复批文件_提交综合计划复批文件_percent">100%</td><td id="提交综合计划复批文件_提交综合计划复批文件_daily">完成</td>
			</tr>
			</neq>
			
			
			
			<!-- 
			<neq name="orgdata.predate7" value="">
			<tr target="sid_obj"><td class="l" id="提交招标文件">提交招标文件</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="提交招标文件_1">提交招标文件</td><td id="提交招标文件_提交招标文件_plantimebegin"><?php if($orgdata['predate6x']!=0)echo date('Y-m-d',strtotime($orgdata['predate6x'])+24*60*60);?></td><td id="提交招标文件_提交招标文件_plantimeend">{$orgdata['predate7']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="提交招标文件_4">提交招标文件</td><td id="提交招标文件_提交招标文件_timebegin"><?php getBegintime($orgdata['planfile_time'],$orgdata['bid_time']);?></td>
				<td id="提交招标文件_提交招标文件_timeend"><?php if($orgdata['bid_time']!=0)echo date('Y-m-d',$orgdata['bid_time']);?></td><td id="提交招标文件_提交招标文件_percent">100%</td><td id="提交招标文件_提交招标文件_daily">完成</td>
			</tr>
			</neq>
			<neq name="orgdata.predate8" value="">
			<tr target="sid_obj"><td class="l" id="提交合同">提交合同</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="提交合同_1">提交合同</td><td id="提交合同_提交合同_plantimebegin"><?php if($orgdata['predate7']!=0)echo date('Y-m-d',strtotime($orgdata['predate7'])+24*60*60);?></td><td id="提交合同_提交合同_plantimeend">{$orgdata['predate8']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="提交合同_4">提交合同</td><td id="提交合同_提交合同_timebegin"><?php getBegintime($orgdata['bid_time'],$orgdata['contract_time']);?></td>
				<td id="提交合同_提交合同_timeend"><?php if($orgdata['contract_time']!=0)echo date('Y-m-d',$orgdata['contract_time']);?></td><td id="提交合同_提交合同_percent">100%</td><td id="提交合同_提交合同_daily">完成</td>
			</tr>
			</neq>
			<neq name="orgdata.predate9" value="">
			<tr target="sid_obj"><td class="l" id="计划编制">计划编制</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="计划编制_1">计划编制</td><td id="计划编制_计划编制_plantimebegin"><?php if($orgdata['predate8']!=0)echo date('Y-m-d',strtotime($orgdata['predate8'])+24*60*60);?></td><td id="计划编制_计划编制_plantimeend">{$orgdata['predate9']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="计划编制_4">计划编制</td><td id="计划编制_计划编制_timebegin"><?php getBegintime($orgdata['contract_time'],$orgdata['plan_time']);?></td>
				<td id="计划编制_计划编制_timeend"><?php if($orgdata['plan_time']!=0)echo date('Y-m-d',$orgdata['plan_time']);?></td><td id="计划编制_计划编制_percent">100%</td><td id="计划编制_计划编制_daily">完成</td>
			</tr>
			</neq> -->
			<neq name="orgdata.predate9x" value="">
			<tr target="sid_obj"><td class="l" id="派发任务单">派发任务单</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="派发任务单_1">派发任务单</td><td id="派发任务单_派发任务单_plantimebegin"><?php if($orgdata['predate9']!=0)echo date('Y-m-d',strtotime($orgdata['predate9'])+24*60*60);?></td><td id="派发任务单_派发任务单_plantimeend">{$orgdata['predate9x']}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="派发任务单_4">派发任务单</td><td id="派发任务单_派发任务单_timebegin"><?php getBegintime($orgdata['plan_time'],$orgdata['sendtask_time']);?></td>
				<td id="派发任务单_派发任务单_timeend"><?php if($orgdata['sendtask_time']!=0)echo date('Y-m-d',$orgdata['sendtask_time']);?></td><td id="派发任务单_派发任务单_percent">100%</td><td id="派发任务单_派发任务单_daily">完成</td>
			</tr>
			</neq>
			
			
			
			
			<volist name="scheduleworktypes" id="scheduleworktype" key="i">
			<tr target="sid_obj">
				<td class="l" id="{$scheduleworktype.worktype}">{$scheduleworktype.worktype}</td>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<volist name="scheduleworktype.schedules" id="schedule" key="j">
					<td class="{$scheduleworktype.worktype}_1">{$schedule.subworktype}</td>
					<td id="{$scheduleworktype.worktype}_{$schedule.subworktype}_plantimebegin">{$schedule['plantimebegin']}</td>
					<td id="{$scheduleworktype.worktype}_{$schedule.subworktype}_plantimeend">{$schedule['plantimeend']}</td>
				</volist>
			</tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<volist name="scheduleworktype.realworks" id="realwork" key="k">
					<td class="{$scheduleworktype.worktype}_4">{$realwork.subworktype}</td>
					<td id="{$scheduleworktype.worktype}_{$realwork.subworktype}_timebegin">{$realwork['timebegin']}</td>
					<td id="{$scheduleworktype.worktype}_{$realwork.subworktype}_timeend">{$realwork['timeend']}</td>
					<td id="{$scheduleworktype.worktype}_{$realwork.subworktype}_percent">{$realwork['percent']}</td>
					<td id="{$scheduleworktype.worktype}_{$realwork.subworktype}_daily">{$realwork['daily']}</td>
				</volist>
			</tr>
			</volist>
			
			
			
			
			<neq name="orgdata.outplantime1" value="">
			<tr target="sid_obj"><td class="l" id="用电申请">用电申请</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="用电申请_1">用电申请</td><td id="用电申请_用电申请_plantimebegin">{$orgdata['outplantime1']}</td><td id="用电申请_用电申请_plantimeend">{$orgdata['outplantime1']}</td>
			</tr>
			<neq name="orgdata.outplantime1x" value="">
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="用电申请_4">用电申请</td><td id="用电申请_用电申请_timebegin">{$orgdata['outplantime1x']}</td>
				<td id="用电申请_用电申请_timeend">{$orgdata['outplantime1x']}</td><td id="用电申请_用电申请_percent">100%</td><td id="用电申请_用电申请_daily">完成</td>
			</tr>
			</neq>
			</neq>
			
			<neq name="orgdata.outplantime2" value="">
			<tr target="sid_obj"><td class="l" id="供电方案答复">供电方案答复</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="供电方案答复_1">供电方案答复</td><td id="供电方案答复_供电方案答复_plantimebegin"><?php if($orgdata['outplantime1']!=0)echo date('Y-m-d',strtotime($orgdata['outplantime1'])+24*60*60);?></td><td id="供电方案答复_供电方案答复_plantimeend">{$orgdata['outplantime2']}</td>
			</tr>
			<neq name="orgdata.outplantime2x" value="">
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="供电方案答复_4">供电方案答复</td><td id="供电方案答复_供电方案答复_timebegin"><?php getBegintimestr($orgdata['outplantime1x'],$orgdata['outplantime2x']);?></td>
				<td id="供电方案答复_供电方案答复_timeend">{$orgdata['outplantime2x']}</td><td id="供电方案答复_供电方案答复_percent">100%</td><td id="供电方案答复_供电方案答复_daily">完成</td>
			</tr>
			</neq>
			</neq>
			
			<neq name="orgdata.outplantime3" value="">
			<tr target="sid_obj"><td class="l" id="停电时间">停电时间</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="停电时间_1">停电时间</td><td id="停电时间_停电时间_plantimebegin"><?php if($orgdata['outplantime2']!=0)echo date('Y-m-d',strtotime($orgdata['outplantime2'])+24*60*60);?></td><td id="停电时间_停电时间_plantimeend">{$orgdata['outplantime3']}</td>
			</tr>
			<neq name="orgdata.outplantime3x" value="">
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="停电时间_4">停电时间</td><td id="停电时间_停电时间_timebegin"><?php getBegintimestr($orgdata['outplantime2x'],$orgdata['outplantime3x']);?></td>
				<td id="停电时间_停电时间_timeend">{$orgdata['outplantime3x']}</td><td id="停电时间_停电时间_percent">100%</td><td id="停电时间_停电时间_daily">完成</td>
			</tr>
			</neq>
			</neq>
			
			<neq name="orgdata.outplantime4" value="">
			<tr target="sid_obj"><td class="l" id="送电时间">送电时间</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="送电时间_1">送电时间</td><td id="送电时间_送电时间_plantimebegin"><?php if($orgdata['outplantime3']!=0)echo date('Y-m-d',strtotime($orgdata['outplantime3'])+24*60*60);?></td><td id="送电时间_送电时间_plantimeend">{$orgdata['outplantime4']}</td>
			</tr>
			<neq name="orgdata.outplantime4x" value="">
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="送电时间_4">送电时间</td><td id="送电时间_送电时间_timebegin"><?php getBegintimestr($orgdata['outplantime3x'],$orgdata['outplantime4x']);?></td>
				<td id="送电时间_送电时间_timeend">{$orgdata['outplantime4x']}</td><td id="送电时间_送电时间_percent">100%</td><td id="送电时间_送电时间_daily">完成</td>
			</tr>
			</neq>
			</neq>
			
			
			
			
			
			
			
			<neq name="orgdata.predate99" value="">
			<tr target="sid_obj"><td class="l" id="联合验收">联合验收</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="联合验收_1">联合验收</td><td id="联合验收_联合验收_plantimebegin">{$maxplantimeend}</td><td id="联合验收_联合验收_plantimeend">{$orgdata['predate100']}</td>
			</tr>
			<neq name="orgdata.finish_time" value="">
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="联合验收_4">联合验收</td><td id="联合验收_联合验收_timebegin">{$maxrealtimeend}</td>
				<td id="联合验收_联合验收_timeend"><?php if($orgdata['finish_time']!=0)echo date('Y-m-d',$orgdata['finish_time']);?></td><td id="联合验收_联合验收_percent">100%</td><td id="联合验收_联合验收_daily">完成</td>
			</tr>
			</neq>
			</neq>
			
			<neq name="orgdata.predate100" value="">
			<tr target="sid_obj"><td class="l" id="竣工验收">竣工验收</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="竣工验收_1">竣工验收</td><td id="竣工验收_竣工验收_plantimebegin">{$maxplantimeend}</td><td id="竣工验收_竣工验收_plantimeend">{$orgdata['predate100']}</td>
			</tr>
			<neq name="orgdata.finish_time" value="">
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="竣工验收_4">竣工验收</td><td id="竣工验收_竣工验收_timebegin">{$maxrealtimeend}</td>
				<td id="竣工验收_竣工验收_timeend"><?php if($orgdata['finish_time']!=0)echo date('Y-m-d',$orgdata['finish_time']);?></td><td id="竣工验收_竣工验收_percent">100%</td><td id="竣工验收_竣工验收_daily">完成</td>
			</tr>
			</neq>
			</neq>
			<neq name="orgdata.predate101" value="">
			<tr target="sid_obj"><td class="l" id="项目验收">项目验收</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="项目验收_1">项目验收</td><td id="项目验收_项目验收_plantimebegin"><?php if($orgdata['predate100']!=0)echo date('Y-m-d',strtotime($orgdata['predate100'])+24*60*60);?></td><td id="项目验收_项目验收_plantimeend">{$orgdata['predate101']}</td>
			</tr>
			<neq name="orgdata.finish_time1" value="">
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="项目验收_4">项目验收</td><td id="项目验收_项目验收_timebegin"><?php getBegintime($orgdata['finish_time'],$orgdata['finish_time1']);?></td>
				<td id="项目验收_项目验收_timeend"><?php if($orgdata['finish_time1']!=0)echo date('Y-m-d',$orgdata['finish_time1']);?></td><td id="项目验收_项目验收_percent">100%</td><td id="项目验收_项目验收_daily">完成</td>
			</tr>
			</neq>
			</neq>
			<neq name="orgdata.predate102" value="">
			<tr target="sid_obj"><td class="l" id="项目投运">项目投运</td></tr>
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="项目投运_1">项目投运</td><td id="项目投运_项目投运_plantimebegin"><?php if($orgdata['predate101']!=0)echo date('Y-m-d',strtotime($orgdata['predate101'])+24*60*60);?></td><td id="项目投运_项目投运_plantimeend">{$orgdata['predate102']}</td>
			</tr>
			<neq name="orgdata.activity_time" value="">
			<tr target="sid_obj" rel="{$listmenu['id']}">
				<td class="项目投运_4">项目投运</td><td id="项目投运_项目投运_timebegin"><?php getBegintime($orgdata['finish_time1'],$orgdata['activity_time']);?></td>
				<td id="项目投运_项目投运_timeend"><?php if($orgdata['activity_time']!=0)echo date('Y-m-d',$orgdata['activity_time']);?></td><td id="项目投运_项目投运_percent">100%</td><td id="项目投运_项目投运_daily">完成</td>
			</tr>
			</neq>
			</neq>
			
		</tbody>
	</table>
	
	
    <div class="wrapper wrapper-content animated">
        <div class="row">
            <div class="col-sm-12">
                <div class="ibox float-e-margins">
                    <div style="background-color:white;height:28px;padding:2px 5px 2px 10px;border-top:4px solid #E7EAEC;border-left:1px solid #DDDDDD;border-right:1px solid #DDDDDD">
                        <h4 style="font-family:微软雅黑">{$detail['title']} &nbsp;&nbsp;<font style="color:red;font-weight:bold">橙色为分部分项计划工期，蓝色为实际工期，红色提示实际工期超期</font>&nbsp;&nbsp;<font style="color:blue;font-weight:bold">甘特图内侧滚动为日期左右滑动，甘特图外侧滚动为上下滑动（生命周期不长则不需左右滑动）</font></h4>
                    </div>
                    <div class="ibox-content">
                        <div class="" id="echarts-line-chart" style="width:1000px;margin:0 auto;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 全局js -->
    <script src="js/jquery.min.js?v=2.1.4"></script>
    <script src="js/bootstrap.min.js?v=3.3.6"></script>


    <!-- 自定义js -->
    <script src="js/content.js?v=1.0.0"></script>
	
	
	
	
	
	<!--包中未包含jquery，你需要自行下载最新版的-->
	<script src="__PUBLIC__/gantt/js/jquery.fn.gantt.js"></script>
	<!--若为jquery1.9以上，还需要引入-->
	<script src="__PUBLIC__/gantt/js/jquery-migrate-1.2.1.min.js"></script>
	
	
	<script type="text/javascript">
	$(function() {
	
		
		var data=[];
		var subdata=[];
		var planarray=[];
		var color="";
		var plmid=document.getElementById("plmid").value;
		$(".l").each(function(i){
			var id=this.id;
			subdata=[];
			$("."+this.id+"_1").each(function(j){
				var subworktype=$(this).html();
				var timebeginstr=document.getElementById(id+"_"+subworktype+"_plantimebegin").innerHTML;
				var timeendstr=document.getElementById(id+"_"+subworktype+"_plantimeend").innerHTML;
				
				timebegin = Date.parse(new Date(timebeginstr))-24*60*60*1000;
				timeend = Date.parse(new Date(timeendstr))-24*60*60*1000;
				
				planarray['"'+subworktype+'"']=timeend;
				//if(j%2==0)color="ganttRed";
				//else color="ganttBlue";
				color="ganttOrange";
				
				var plan=subworktype + "(计划) : " +timebeginstr+" ~ "+timeendstr;
				subdata[j]={
					from:timebegin,   //起始时间，13位时间戳,这里不同于原版"/Date(1333411200000)/"  
					to:timeend,     //终止时间，13位时间戳,这里不同于原版"/Date(1333411200000)/"  
					desc:plan,       //描述  
					label:subworktype,  //显示在进度条上的标签
					customClass:color
				};
			})
			
			
			if((i>=140)&&(id!="用电申请")&&(id!="供电方案答复")&&(id!="停电时间")&&(id!="送电时间")&&(id!="竣工验收")&&(id!="项目验收")&&(id!="项目投运"))
			{
				data[2*i]={
					name: "<a href='__APP__/Xmtj/subworkganteiframe/id/"+plmid+"/worktype/"+$(this).html()+"' data-toggle='modal' data-target='#modal'>"+$(this).html()+"(计划)</a>",
					values:subdata
				};
			}
			else
			{
				data[2*i]={
					name: $(this).html()+"(计划)",
					values:subdata
				};
			}
			
			//实际
			subdatareal=[];
			$("."+this.id+"_4").each(function(j){
				var subworktype=$(this).html();
				var timebeginstr=document.getElementById(id+"_"+subworktype+"_timebegin").innerHTML;
				var timeendstr=document.getElementById(id+"_"+subworktype+"_timeend").innerHTML;
				var percent=document.getElementById(id+"_"+subworktype+"_percent").innerHTML;
				var daily=document.getElementById(id+"_"+subworktype+"_daily").innerHTML;
				
				timebegin = Date.parse(new Date(timebeginstr))-24*60*60*1000;
				timeend = Date.parse(new Date(timeendstr))-24*60*60*1000;
				
				//if(j%2==0)color="ganttRed";
				//else color="ganttBlue";
				color="ganttBlue";
				//if(timeend>planarray['"'+subworktype+'"'])
				if((timeend>planarray['"'+subworktype+'"'])||(timebegin>planarray['"'+subworktype+'"']))
				{
					color="ganttRed";
				}
				console.log(timebegin);
				if(!isNaN(timebegin))
				{
					var plan=subworktype + "(实际完成) : " +percent+daily+"("+timebeginstr+" ~ "+timeendstr+")";
					subdatareal[j]={
						from:timebegin,   //起始时间，13位时间戳,这里不同于原版"/Date(1333411200000)/"  
						to:timeend,     //终止时间，13位时间戳,这里不同于原版"/Date(1333411200000)/"  
						desc:plan,       //描述  
						label:subworktype,  //显示在进度条上的标签
						customClass:color
					};
				}
			})
			
			if((i>=140)&&(id!="用电申请")&&(id!="供电方案答复")&&(id!="停电时间")&&(id!="送电时间")&&(id!="竣工验收")&&(id!="项目验收")&&(id!="项目投运"))
			{
				data[2*i+1]={
					name: "<a href='__APP__/Xmtj/subworkganteiframe/id/"+plmid+"/worktype/"+$(this).html()+"' data-toggle='modal' data-target='#modal'>"+$(this).html()+"(实际)</a>",
					values:subdatareal
				};
			}
			else
			{
				data[2*i+1]={
					name: $(this).html()+"(实际)",
					values:subdatareal
				};
			}
		})
		
		$('#echarts-line-chart').gantt({
			source: data,	//显示的数据，见下面分析
			navigate: "scroll",	//显示成scroll还是buttons
			months: ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"],	//月份显示的语言
			dow: ["日", "一", "二", "三", "四", "五", "六"],	//星期显示的语言
			scale: "days",	//默认显示的粒度
			maxScale: "months",	//最大显示的粒度
			minScale: "days",	//最小显示的粒度
			itemsPerPage: 48,	//每页显示的数目
			onItemClick: function(data) {	//进度条显示的单击事件,data参见source定义
				//alert("Item clicked - show some details" + data);
			},
			onAddClick: function(dt, rowId) {	//图表空白处的单击事件
				
			},
			onRender: function() {	//渲染时的事件
				
			}
		});

	});
	</script>
	
	
	
	
	<div id="modal" class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg">
		<div class="modal-content">
		   <div class="modal-header">  
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">  
                    <span aria-hidden="true">×</span>  
                </button>  
                <h4 class="modal-title" id="myModalLabel">正在加载</h4>  
            </div>  
            <div class="modal-body">  
                <p>正在加载…</p>  
            </div>  
            <div class="modal-footer">  
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>  
                <button type="button" class="btn btn-primary">Save</button>  
            </div>  
		</div>
	  </div>
	</div>
	<script>
        $(document).ready(function () {
            //$('.dataTables-example').dataTable();
            //var oTable = $('#editable').dataTable();
			$("#modal").on("hidden.bs.modal", function() {
				$(this).removeData("bs.modal");  
			});
        });
    </script>
</body>

</html>
