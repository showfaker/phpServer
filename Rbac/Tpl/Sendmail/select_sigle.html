<tagLib name="html" />
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<TITLE>选择员工</title>
<load type="css" href ="../Public/css/style.css" />
<script language="JavaScript">
<!--
function ok(){
	var result = new Array();
	var obj	   = form1.group.options;
	var j=0;
	for(var i=0;i<obj.length;i++){
		if (obj[i].selected==true){
			result[j] = new Array();
			result[j][0]	=	obj[i].text;
			result[j][1]	=	obj[i].value;
			j++;
		}
	}
	returnValue=result;
	window.close(); 
}
var stylerecord=-1;
function insertopt(deptname,style){/*0为按部门选择，1为按职位选择*/
	var userall = "<?php echo $userdept;?>";
    //alert(userall);
    if((style!=stylerecord)&&(stylerecord!=-1))
    {
    		document.getElementById('select1').length=0;   		
    		/*去掉选择*/
    		var a = document.getElementsByTagName("input");
    		for (var i=0; i<a.length; i++)
    		{
    		      if ((a[i].type == "checkbox")&&(a[i].id!=deptname))
    		    	  a[i].checked = false;
    		}
    		//document.getElementById(deptname).checked=0；
    }
    stylerecord=style;
    do
    {
	    var index1 = userall.indexOf(",");
	    var sub_string1 = userall.substring(0,index1);
	    //alert(sub_string1);
	    var userall = userall.replace(sub_string1+',',"");    
	    var index2 = sub_string1.indexOf(deptname);
	    if(index2!=-1)
	    {
	    	if(document.getElementById(deptname).checked)
	    		document.getElementById('select1').add(new Option(sub_string1,sub_string1));
	    	else
	    	{	
	    		//document.getElementById('select1').remove(Option(sub_string1,sub_string1));
	    		var o=document.getElementById('select1');
	    		//alert(o.length);
	    		for(var i = 0; i < o.length; i++) {
	           		if (o[i].value == sub_string1)
	           		{
	           			//alert(o[i].index);
	           			o.remove(o[i].index);
           			}
	    		}
	    	}
	    }
    }while(index1!=-1)
}

//-->
</script>
<base target="_self" />
</head>
<body style="margin:0;overflow:hidden">
<form method="post" style="margin:0" name = "form1" action=""><!-- {__NOTOKEN__} -->

<div align="left">
<label>按部门选择</label></br>
<voList name="dept" id="dept" >
<input type="checkbox" name="{$dept.name}" id="{$dept.name}" value="{$dept.id}"  onclick="insertopt('{$dept.name}',0)" />{$dept.name}<br>
</voList>
<label>按职位选择</label></br>
<voList name="role" id="role" >
<input type="checkbox" name="{$role.name}" id="{$role.name}" value="{$role.id}"  onclick="insertopt('{$role.name}',1)" />{$role.name}<br>
</voList>
<!--
<div align="center">
<voList name="dept" id="dept1">
	a
</voList>
</div>
 -->
<!-- 
<label>按部门选择</label>
<voList name="dept" id="dept" >
<div>
<input type="checkbox" name="" />{$dept.name}
</div>
</voList> -->


<table id="table1" class="order" cellpadding=0 style="margin:0;position:absolute;right:5px;top:10px;width:16px" cellspacing=0 width="100%">
<tr><td height="5" colspan="2" class="topTd" ></td></tr>
<tr >
	<td width="100%" align="right">
	<div class="solid">
	<select style="width:180px" id="select1" ondblclick="ok()" name="group" size="15" ><!-- multiple="true" -->
<!-- <option value="">无主管</option>
 <voList name="user" id="user" >
<option value="{$user.id}">{$user.namenumber}</option>
</voList>-->
</select></div></td>
</tr>
<tr>
	<td colspan=2 align="right">
	<div style="width:65%">
<input type="submit" value="确 定" onClick="ok()" class="submit hMargin " /> 
<input name="reset" type="reset" value="取 消" onClick="window.close()" class="submit small " />
</div>
</td>
</tr>
<tr><td height="5" colspan="2" class="topTd" ></td></tr>
</table>
</div>
</form>




</html>